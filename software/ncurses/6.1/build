NAME="ncurses"
FILENAME="ncurses-6.1.tar.gz"
SOURCE="https://mirrors.dotsrc.org/gnu/ncurses/$FILENAME"

build() {
	tar xf "$CACHE_DIR/$FILENAME" -C "$BUILD_DIR"
	cd "$BUILD_DIR/ncurses-6.1"
	
	./configure \
		--prefix= \
		--with-shared \
		--without-debug \
		--disable-stripping \
		--without-manpages \
		--enable-static=no \
		--enable-widec \
		--without-ada \
		--host=$ARCH

	make -j$(nproc) V=1
}

install() {
	make install DESTDIR=/Programs/ncurses/6.1
	unlink /Programs/ncurses/6.1/lib/terminfo
	rm -rf /Programs/ncurses/6.1/lib/*.a
	
	mkdir -p /Programs/ncurses/6.1/share/pkgconfig
	for lib in ncurses form panel menu; do
    		rm -vf /Programs/ncurses/6.1/lib/lib${lib}.so
    		echo "INPUT(-l${lib}w)" > /Programs/ncurses/6.1/lib/lib${lib}.so
    		ln -sfv ${lib}w.pc /Programs/ncurses/6.1/share/pkgconfig/${lib}.pc
	done
	
	rm -f /Programs/ncurses/6.1/lib/libcursesw.so
	echo "INPUT(-lncursesw)" > /Programs/ncurses/6.1/lib/libcursesw.so
	ln -sf libncurses.so /Programs/ncurses/6.1/lib/libcurses.so
}
