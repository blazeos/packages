if [ -z "$2" ]; then
  echo "You need to specify the package name to uninstall."
  exit 1
fi

PACKAGE=$2
VERSION=$3

if [ -z "$VERSION" ]; then
  VERSION=$(readlink /Programs/$PACKAGE/current) || true
  if [ -z "$VERSION" ]; then
    echo "Please specify which version to uninstall."
    exit 1
  fi
fi

#check if specified version and package exists
#if version specified is the current one, unlink current
#the installer should autolink all the common directories, add a flag to disable!

find /Programs/$PACKAGE/$VERSION/bin -not -type d | \
while read path; do
  file="${path/\/Programs\/$PACKAGE\/$VERSION\/bin\//}" 
  echo $file
  
  unlink "/System/Index/Binaries/$file" > /dev/null || true
done

echo "Done!"
